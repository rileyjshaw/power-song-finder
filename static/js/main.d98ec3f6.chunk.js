(this["webpackJsonppower-song-finder"]=this["webpackJsonppower-song-finder"]||[]).push([[0],{16:function(e,t,n){},18:function(e,t,n){},20:function(e,t,n){"use strict";n.r(t);var r=n(2),c=n(1),o=n.n(c),a=n(9),s=n.n(a),i=(n(16),n(8)),u=n.n(i),l=n(11),d=n(10),j=n(3),h=n(5);function b(e){var t=Object(c.useState)({}),n=Object(r.a)(t,2),o=n[0],a=n[1];return Object(c.useEffect)((function(){function t(t){var n,r=t.key,c=e[r];c&&!o[r]&&(a((function(e){return Object(j.a)(Object(j.a)({},e),{},Object(h.a)({},r,!0))})),null===(n=c.onDown)||void 0===n||n.call(c))}function n(t){var n,r=t.key,c=e[r];c&&o[r]&&(a((function(e){return Object(j.a)(Object(j.a)({},e),{},Object(h.a)({},r,!1))})),null===(n=c.onUp)||void 0===n||n.call(c))}return window.addEventListener("keydown",t),window.addEventListener("keyup",n),function(){window.removeEventListener("keydown",t),window.removeEventListener("keyup",n)}}),[e]),o}function p(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=t.delay,r=void 0===n?500:n,o=t.interval,a=void 0===o?20:o,s=t.maxRepeats,i=void 0===s?0:s,u=Object(c.useRef)(null),l=Object(c.useRef)(0),d=Object(c.useCallback)((function(){e(),(!i||++l.current<i)&&(u.current=setTimeout(d,a))}),[e,a,i]),j=Object(c.useCallback)((function(){u.current||(u.current=setTimeout(d,r))}),[d,r]),h=Object(c.useCallback)((function(){clearTimeout(u.current),u.current=null,(!i||l.current<i)&&e(),l.current=0}),[e,i]);return[j,h]}n(18);var f=n(0),m="https://api.spotify.com",O="https://accounts.spotify.com/authorize?client_id=".concat("a6babd5bf4654f2998b1afa67c1866cf","&response_type=token&redirect_uri=").concat("https://rileyjshaw.com/power-song-finder/","&scope=").concat(encodeURIComponent(["user-top-read","user-read-email"].join(" ")),"&state=").concat("POWER_SONG","&show_dialog=").concat(!1),x=function(e){return Math.max(60,Math.min(240,e))},w=function(){return Object(f.jsx)("svg",{version:"1.1",xmlns:"http://www.w3.org/2000/svg",xmlnsXlink:"http://www.w3.org/1999/xlink",viewBox:"0 0 100 100",children:Object(f.jsx)("polygon",{points:"20,10 20,90 80,50"})})},v=function(){return Object(f.jsxs)("svg",{version:"1.1",xmlns:"http://www.w3.org/2000/svg",xmlnsXlink:"http://www.w3.org/1999/xlink",viewBox:"0 0 100 100",children:[Object(f.jsx)("rect",{x:"20",y:"25",width:"20",height:"50"}),Object(f.jsx)("rect",{x:"52",y:"25",width:"20",height:"50"})]})},g=[{title:"Find your Power Song",Main:function(){return Object(f.jsxs)("div",{className:"Intro",children:[Object(f.jsx)("p",{className:"unitalic",children:"This application searches your favorite Spotify tracks for a running \u201cPower Song\u201d. A Power Song matches your target cadence, and pumps you up during a tough point in the run."}),Object(f.jsxs)("blockquote",{children:[Object(f.jsx)("p",{children:"In carefully controlled experiments, adding a soundtrack helps rowers, sprinters, and swimmers shave seconds off their times. Runners can tolerate extreme heat and humidity longer, and triathletes can push themselves farther before reaching exhaustion. Moving to music even leads athletes to consume less oxygen as they exert themselves, as if the song itself supplies some of the energy they need. Findings like this led the authors of a scientific review in the Annals of Sports Medicine and Research to conclude that music is a legal performance-enhancing drug."}),Object(f.jsxs)("footer",{children:["\u2014"," ",Object(f.jsx)("cite",{children:Object(f.jsxs)("a",{href:"https://www.penguinrandomhouse.com/books/564895/the-joy-of-movement-by-kelly-mcgonigal/",target:"_blank",rel:"noopener noreferrer",children:["Kelly McGonigal, ",Object(f.jsx)("em",{className:"unitalic",children:"\u201cThe Joy of Movement\u201d"})]})})]})]}),Object(f.jsx)("p",{className:"unitalic",children:"Cadence is defined in Beats Per Minute, or \u201cBPM\u201d. Your target BPM corresponds to how many strides you take per minute. Most recreational runners have a cadence between 150 BPM and 170 BPM, but your cadence is unique to your needs and goals as a runner."})]})},Footer:function(){return Object(f.jsxs)("p",{children:["To get started, ",Object(f.jsx)("a",{href:O,children:"log in with Spotify"}),"."]})}},{title:"Set your target cadence",Main:function(e){var t=e.targetTempo,n=e.setTargetTempo,o=p((function(){return n((function(e){return e+1}))})),a=Object(r.a)(o,2),s=a[0],i=a[1],u=p((function(){return n((function(e){return e-1}))})),l=Object(r.a)(u,2),d=l[0],j=l[1];return b(Object(c["useMemo"])((function(){return{ArrowUp:{onDown:s,onUp:i},ArrowRight:{onDown:s,onUp:i},ArrowDown:{onDown:d,onUp:j},ArrowLeft:{onDown:d,onUp:j}}}),[d,j,s,i])),Object(f.jsxs)("div",{className:"Tempo-select",children:[Object(f.jsx)("button",{onMouseDown:s,onMouseUp:i,className:"Tempo-button",children:"\u25b2"}),Object(f.jsxs)("div",{className:"Tempo-container",children:[Object(f.jsx)("span",{className:"Tempo-value",children:t}),Object(f.jsx)("span",{className:"Tempo-bpm",children:"BPM"})]}),Object(f.jsx)("button",{onMouseDown:d,onMouseUp:j,className:"Tempo-button",children:"\u25bc"})]})},Footer:function(e){var t=e.setStep;return Object(f.jsxs)("p",{children:["Once you\u2019ve chosen a cadence,"," ",Object(f.jsx)("button",{className:"Button-link",onClick:function(){return t((function(e){return e+1}))},children:"pick your Power Song"}),"."]})}},{title:"Pick your Power Song",Main:function(e){var t=e.tracks,n=e.targetTempo;return t&&Object(f.jsxs)("table",{children:[Object(f.jsx)("thead",{children:Object(f.jsxs)("tr",{children:[Object(f.jsx)("th",{scope:"col",children:"Title"}),Object(f.jsx)("th",{scope:"col",children:"Artist"}),Object(f.jsx)("th",{scope:"col",children:"Duration"}),Object(f.jsx)("th",{scope:"col",children:"BPM"}),Object(f.jsx)("th",{scope:"col",children:"Error"}),Object(f.jsx)("th",{scope:"col",children:"Preview"})]})}),Object(f.jsx)("tbody",{children:t.map((function(e){for(var t=e.bpm,r=e.bpm-n,c=1;c<=3;++c){var o=Math.pow(2,c),a=e.bpm*o,s=a-n,i=e.bpm/o,u=i-n;k(u,r)<0?(t=i,r=u):k(s,r)<0&&(t=a,r=s)}return Object(j.a)(Object(j.a)({},e),{},{bpm:t,error:r})})).sort((function(e,t){return k(e.error,t.error)})).map((function(e){return Object(f.jsxs)("tr",{children:[Object(f.jsx)("td",{children:Object(f.jsx)("a",{href:e.url,target:"_blank",rel:"noopener noreferrer",children:e.title})}),Object(f.jsx)("td",{children:e.artist}),Object(f.jsx)("td",{children:e.duration}),Object(f.jsx)("td",{children:Math.round(e.bpm)}),Object(f.jsx)("td",{children:"".concat(["-","","+"][Math.sign(e.error)+1]).concat(parseFloat((Math.abs(e.error)/n*100).toFixed(1)),"%")}),Object(f.jsx)("td",{children:Object(f.jsx)(y,{url:e.preview})})]},"".concat(e.title,"|").concat(e.artist))}))})]})},Footer:function(e){var t=e.setStep;return Object(f.jsxs)("p",{children:["Or,"," ",Object(f.jsx)("button",{className:"Button-link",onClick:function(){return t((function(e){return Math.max(0,e-1)}))},children:"try another cadence"}),"."]})}}];function y(e){var t=e.url,n=Object(c.useState)(!1),o=Object(r.a)(n,2),a=o[0],s=o[1],i=Object(c.useMemo)((function(){var e=new Audio;return e.preload="none",e.addEventListener("ended",(function(){return s(!1)})),e}),[]);Object(c.useEffect)((function(){i.src=t}),[i,t]);var u=Object(c.useCallback)((function(){s((function(e){return!e})),i.paused||i.ended?i.play():i.pause()}),[i]);return Object(f.jsx)("button",{onClick:u,children:a?Object(f.jsx)(v,{}):Object(f.jsx)(w,{})})}var k=function(e,t){return Math.abs(e)-Math.abs(t)||Math.sign(e)-Math.sign(t)};var M=function(e){var t=e.queryParams,n=Object(c.useState)(t.access_token?1:0),o=Object(r.a)(n,2),a=o[0],s=o[1],i=Object(c.useState)(150),j=Object(r.a)(i,2),h=j[0],b=j[1],p=Object(c.useState)(null),O=Object(r.a)(p,2),w=O[0],v=O[1];Object(c.useEffect)((function(){document.documentElement.style.setProperty("--hue",16+200*(1-(h-60)/180))}),[h]);var y=Object(c.useCallback)((function(e){b("function"===typeof e?function(t){return x(e(t))}:x(e))}),[]);Object(c.useEffect)((function(){if(t.access_token){v([]);var e="".concat(t.token_type," ").concat(t.access_token),n="?limit=50";Object(d.a)(u.a.mark((function t(){var r;return u.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:r=function(t){var r=t.next,c=t.items;n=r&&r.slice(r.indexOf("?")),c.forEach((function(t){fetch("".concat(m,"/v1/audio-features/").concat(t.id),{headers:{Authorization:e}}).then((function(e){return e.json()})).then((function(e){v((function(n){return[].concat(Object(l.a)(n),[{id:t.id,title:t.name,artist:t.artists.map((function(e){return e.name})).join(", "),duration:(r=t.duration_ms,"".concat(Math.floor(r/6e4),":").concat("".concat(Math.floor(r/1e3)%60).padStart(2,0))),bpm:e.tempo,preview:t.preview_url,url:t.external_urls.spotify,features:e}]);var r}))}))}))};case 1:if(!n){t.next=6;break}return t.next=4,fetch("".concat(m,"/v1/me/top/tracks").concat(n),{headers:{Authorization:e}}).then((function(e){return e.json()})).then(r);case 4:t.next=1;break;case 6:case"end":return t.stop()}}),t)})))()}}),[t.access_token,t.token_type]);var k=g[a],M=k.title,S=k.Main,T=k.Footer;return Object(f.jsxs)("div",{className:"App",children:[Object(f.jsx)("header",{className:"Header",children:Object(f.jsx)("h1",{children:M})}),Object(f.jsx)("main",{children:Object(f.jsx)(S,{targetTempo:h,setTargetTempo:y,tracks:w})}),Object(f.jsx)("footer",{className:"Footer",children:Object(f.jsx)(T,{setStep:s})})]})},S=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,21)).then((function(t){var n=t.getCLS,r=t.getFID,c=t.getFCP,o=t.getLCP,a=t.getTTFB;n(e),r(e),c(e),o(e),a(e)}))},T=window.location.hash.slice(1).split("&").reduce((function(e,t){if(t){var n=t.split("="),c=Object(r.a)(n,2),o=c[0],a=c[1];e[o]=decodeURIComponent(a)}return e}),{});window.history.replaceState({},document.title,window.location.pathname),s.a.render(Object(f.jsx)(o.a.StrictMode,{children:Object(f.jsx)(M,{queryParams:T})}),document.getElementById("root")),S()}},[[20,1,2]]]);
//# sourceMappingURL=main.d98ec3f6.chunk.js.map